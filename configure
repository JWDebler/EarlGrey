# Short script to configure Earl Grey to run on any system in a portable manner

# check presence of RepeatMasker and RepeatModeler
echo "Checking RepeatMasker and RepeatModeler configuration"
type RepeatMasker >/dev/null 2>&1 || { echo >&2 "Earl Grey requires RepeatMasker but it's not installed.  Aborting."; exit 1; }
type RepeatModeler >/dev/null 2>&1 || { echo >&2 "Earl Grey requires RepeatMasker but it's not installed.  Aborting."; exit 1; }

# set paths in Earl Grey Script

echo "Setting path variables in script"
SCRIPT_DIR=$(realpath ./scripts/)
sed -i "s|INSERTFILEPATHHERE|${SCRIPT_DIR}|g" ./earlGrey
sed -i "s|INSERTFILEPATHHERE|${SCRIPT_DIR}|g" ./scripts/rcMergeRepeat*
sleep 3
echo "Path variables set"
sleep 3

# Extract tRNAdb
echo "Extracting zip archives"
unzip ./scripts/bin/LTR_FINDER.x86_64-1.0.7/tRNAdb.zip
echo "Extracted required archives"
sleep 3

# Message Complete
echo "Remember to activate the earl grey conda environment before running earlGrey"
sleep 3
echo "earlGrey command can be added to path to be run from any directory"
